---
import '/src/styles/globals.css';
import { Mail, Download, ArrowUpRight } from '@lucide/astro';
import { Image } from 'astro:assets';
import myBitmoji from '../assets/bitmoji.png';
import Encryptedtext from './Encryptedtext.astro';
import Seperator from './Seperator.astro';
import GradientBorder from './GradientBorder.astro';
import GlowCard from './ui/GlowCard.astro';
import HeroLamp from './ui/HeroLamp.astro';
import GlowCardMotion from './hero/GlowCardMotion';

const github = "data:image/svg+xml;base64,...";
const linkedin = "data:image/svg+xml;base64,...";
const bluesky = "data:image/svg+xml;base64,...";

const logos = [
  { icon: 'logos:react', color: '#61DAFB', x: 0, y: -117, startX: 600, startY: 0, startScale: 6.8, enterDelay: 0.4, floatDelay: 2 },
  { icon: 'logos:laravel', color: '#FF2D20', x: 91, y: -73, startX: 120, startY: 20, startScale: 6.2, enterDelay: 0.4, floatDelay: 1.6 },
  { icon: 'logos:python', color: '#3776AB', x: 114, y: 26, startX: 650, startY: 0, startScale: 6.2, enterDelay: 0.3, floatDelay: 3.2 },
  { icon: 'logos:linux-tux', color: '#FCC624', x: 51, y: 105, startX: 600, startY: 0, startScale: 6.8, enterDelay: 0.2, floatDelay: 2.1 },
  { icon: 'logos:vue', color: '#4FC08D', x: -51, y: 105, startX: 650, startY: 0, startScale: 6.2, enterDelay: 0.4, floatDelay: 1.5 },
  { icon: 'logos:nodejs-icon', color: '#339933', x: -114, y: 26, startX: 140, startY: -10, startScale: 6.2, enterDelay: 0.2, floatDelay: 1.3 },
  { icon: 'logos:docker-icon', color: '#2496ED', x: -91, y: -73, startX: 650, startY: 0, startScale: 6.2, enterDelay: 0.2, floatDelay: 2.1 },
];

const socialLinks = [
  { icon: 'https://api.iconify.design/simple-icons:github.svg', link: 'https://github.com/rywils', isImage: true },
  { icon: 'https://api.iconify.design/simple-icons:linkedin.svg', link: 'https://linkedin.com/in/rywils', isImage: true },
  { icon: 'https://api.iconify.design/simple-icons:bluesky.svg', link: 'https://bsky.app/rywils', isImage: true },
  { Icon: Mail, link: 'mailto:ryan@ryanwilson.io', isImage: false },
];
---

<div class="relative flex h-full w-full flex-col overflow-x-hidden border-b border-[#10191d] shadow-md shadow-[#0a0a0a] antialiased md:items-center md:justify-center sm:overflow-visible">
  <div class="p-4 mx-auto relative z-10 w-full pt-10 md:pt-0">
    <section id="hero" class="flex flex-col justify-center relative py-6 overflow-visible">
      <HeroLamp />

      <GlowCardMotion className="mt-10 max-w-4xl mx-auto" client:load>
        <div class="max-w-5xl mx-auto px-8 sm:px-12 lg:px-16 relative z-50 h-full flex justify-center">
          <div class="flex flex-col lg:flex-row justify-center gap-12 lg:gap-20 relative z-50 w-full max-w-5xl mx-auto p-4">

            <!-- AVATAR + SKILLS -->
            <div class="mt-12 lg:mt-0 mb-8 lg:mb-0 flex justify-center flex-shrink-0 items-center">
              <div class="relative grid h-[216px] w-[216px] place-items-center sm:translate-x-0">
                <div class="relative z-20 grid h-[200px] w-[200px] place-items-center">
                  <Image src={myBitmoji} alt="Avatar" class="h-[200px] w-[200px] rounded-full border-4 border-[rgba(138,77,255,0.2)]" loading="eager" />
                </div>

                <!-- SOFI-STYLE ICONS -->
                <div class="pointer-events-none absolute left-1/2 top-1/2 z-10 h-0 w-0 -translate-x-1/2 -translate-y-1/2">
                  {logos.map((logo) => (
                    <span
                      class="skill"
                      style={`--glow:${logo.color}; --x:${logo.x}px; --y:${logo.y}px; --start-x:${logo.startX}px; --start-y:${logo.startY}px; --start-scale:${logo.startScale}; --enter-delay:${logo.enterDelay}s; --float-delay:${logo.floatDelay}s;`}
                    >
                      <img src={`https://api.iconify.design/${logo.icon}.svg`} alt="" />
                    </span>
                  ))}
                </div>
              </div>
            </div>

            <!-- TEXT -->
            <div class="text-center lg:text-left flex-1 max-w-2xl relative z-50">
              <h1 class="text-3xl sm:text-5xl mb-2 font-bold text-(--primary-green)">
                Ryan Wilson
              </h1>

              <p class="text-sm md:text-lg lg:text-xl text-muted-foreground">
                Solutions Architect & Full-Stack Developer
              </p>

              <div class="text-sm md:text-lg mb-4 uppercase flex gap-2 h-5 items-center justify-center lg:justify-start text-muted-foreground">
                <Encryptedtext text="Security" />
                <Seperator orientation="vertical" />
                <Encryptedtext text="Linux" revealDelayMs={200} flipDelayMs={50} />
                <Seperator orientation="vertical" />
                <Encryptedtext text="DevOps" revealDelayMs={300} flipDelayMs={50} />
              </div>

              <GradientBorder />

              <p class="text-lg max-w-2xl mx-auto lg:mx-0 mb-8 text-muted-foreground">
                I'm a Solutions Architect, Full-Stack Developer, and Cybersecurity Enthusiast. I primarily come from a background of network engineering and cloud architecture with a passion for building efficient, scalable, and secure digital solutions.
              </p>
            </div>
          </div>
        </div>

        <!-- SOCIALS -->
        <div class="absolute top-5 right-5 z-50 flex flex-col items-center gap-3" style="--social-delay: 1.4s;">
          {socialLinks.map(({ icon, link, isImage }, index) => (
            <a
              href={link}
              target="_blank"
              rel="noopener noreferrer"
              class={`social__link social__link-${index + 1} flex h-8 w-8 items-center justify-center rounded-full border border-[var(--secondary-purple)] glow-primary-purple transition hover:scale-110`}
            >
              {isImage ? <span class="social-icon" style={`--icon-url: url(${icon});`}></span> : <Mail size={16} color="var(--secondary-purple)" />}
            </a>
          ))}
        </div>
      </GlowCardMotion>
    </section>
  </div>
</div>

<style>
.skill {
  position: absolute;
  top: 0;
  left: 0;
  width: 42px;
  height: 42px;
  background: rgba(10,10,10,.9);
  border-radius: 10px;
  border: 1.5px solid var(--glow);
  box-shadow: 0 0 14px color-mix(in srgb, var(--glow) 65%, transparent);
  opacity: 0;
  transform: translate(-50%, -50%) translate(var(--x), var(--y));
  animation:
    from-right 1.3s ease-in-out forwards var(--enter-delay),
    floating 5s ease-in-out var(--float-delay) infinite;
}

.skill img {
  width: 70%;
  height: 70%;
  margin: 15%;
}

.social-icon {
  width: 16px;
  height: 16px;
  display: inline-block;
  background-color: var(--secondary-purple);
  filter: drop-shadow(0 0 9px rgba(138, 43, 226, 0.7));
  -webkit-mask-image: var(--icon-url);
  -webkit-mask-repeat: no-repeat;
  -webkit-mask-position: center;
  -webkit-mask-size: contain;
  mask-image: var(--icon-url);
  mask-repeat: no-repeat;
  mask-position: center;
  mask-size: contain;
}

@keyframes bounce-in-left {
  0% {
    transform: translateX(-500px) scale(1);
    animation-timing-function: ease-in;
    opacity: 0;
  }
  38% {
    transform: translateX(0) scale(0.94);
    animation-timing-function: ease-out;
    opacity: 1;
  }
  55% {
    transform: translateX(-65px) scale(1.02);
    animation-timing-function: ease-in;
  }
  72% {
    transform: translateX(0) scale(0.96);
    animation-timing-function: ease-out;
  }
  81% {
    transform: translateX(-28px) scale(1.01);
    animation-timing-function: ease-in;
  }
  90% {
    transform: translateX(0) scale(0.98);
    animation-timing-function: ease-out;
  }
  95% {
    transform: translateX(-8px) scale(1.005);
    animation-timing-function: ease-in;
  }
  100% {
    transform: translateX(0) scale(1);
    animation-timing-function: ease-out;
  }
}

.social__link-1 {
  animation: bounce-in-left 1.5s both;
  animation-delay: calc(var(--social-delay, 2.2s) + 0.2s);
}

.social__link-2 {
  animation: bounce-in-left 1.5s both;
  animation-delay: calc(var(--social-delay, 2.2s) + 0.35s);
}

.social__link-3 {
  animation: bounce-in-left 1.5s both;
  animation-delay: calc(var(--social-delay, 2.2s) + 0.5s);
}

.social__link-4 {
  animation: bounce-in-left 1.5s both;
  animation-delay: calc(var(--social-delay, 2.2s) + 0.65s);
}

@media (prefers-reduced-motion: reduce) {
  .social__link {
    animation: none;
    transform: none;
  }
}

@keyframes from-right {
  from {
    opacity: 0;
    transform:
      translate(-50%, -50%)
      translate(var(--x), var(--y))
      translate(var(--start-x), var(--start-y))
      scale(var(--start-scale));
  }
  to {
    opacity: 1;
    transform:
      translate(-50%, -50%)
      translate(var(--x), var(--y))
      scale(1);
  }
}

@keyframes floating {
  0%, 100% { translate: 0 0; }
  50% { translate: 0 -6px; }
}
</style>
